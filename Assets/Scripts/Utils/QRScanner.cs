using UnityEngine;\nusing UnityEngine.Events;\nusing ZXing;\nusing ZXing.QrCode;\nusing System.Collections.Generic;\n\nnamespace ARPathShower.Utils\n{\n    public class QRScanner : MonoBehaviour\n    {\n        [System.Serializable]\n        public class QRCodeScannedEvent : UnityEvent<string>\n        {\n        }\n\n        public static QRScanner Instance { get; private set; }\n\n        public QRCodeScannedEvent OnQRCodeScanned = new QRCodeScannedEvent();\n\n        private void Awake()\n        {\n            if (Instance != null && Instance != this)\n            {\n                Destroy(gameObject);\n            }\n            else\n            {\n                Instance = this;\n                DontDestroyOnLoad(gameObject);\n            }\n        }\n\n        /// <summary>\n        /// Attempts to scan a QR code from a given texture.\n        /// </summary>\n        /// <param name="texture">The texture to scan for a QR code.</param>\n        public void ScanQRCodeFromTexture(Texture2D texture)\n        {\n            if (texture == null)\n            {\n                Debug.LogError("Texture is null. Cannot scan QR code.");\n                return;\n            }\n\n            try\n            {\n                // Convert Texture2D to Luminance source for ZXing\n                var luminanceSource = new BitmapLuminanceSource(texture.ToBitmap());\n                var reader = new MultiFormatReader();\n\n                // Define the barcode format to search for (QR Code)\n                var hints = new Dictionary<DecodeHintType, object> { { DecodeHintType.TRY_HARDER, true } };\n\n                // Attempt to decode the QR code\n                var result = reader.decode(luminanceSource, hints);\n\n                if (result != null)\n                {\n                    Debug.Log("QR Code Scanned: " + result.Text);\n                    OnQRCodeScanned.Invoke(result.Text);\n                }\n                else\n                {\n                    Debug.Log("No QR Code found in the texture.");\n                }\n            }\n            catch (Exception ex)\n            {\n                Debug.LogError("Error scanning QR code: " + ex.Message);\n            }\n        }\n    }\n}\n